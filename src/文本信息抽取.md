# 文本信息抽取

<!-- toc -->

# 信息抽取概述

什么是信息抽取？

将文本中的非结构化信息自动提取转换为结构化数据，并转化为可供计算机能够处理的知识。

信息抽取常见任务：命名实体识别、关系抽取、事件抽取

常用方法：基于规则和模板匹配、基于统计模型和基于深度学习

## 基于规则和模板匹配

基本思想：匹配规则，将文本与规则进行匹配来识别命名实体，适用于抽取可控且表达规范的信息

制定规则方式：人工编写、使用学习方法自动学习

优势：准确，有些命名实体只能通过规则提取

局限：

1. 需要专家制定大量的推理规则
2. 需要谨慎处理规则之间的冲突问题
3. 泛化性比较差，不便于优化

示例：正则表达式提取电话号码
## 序列标注

什么是序列标注？

序列标注是对自然语言文本中的每个词或子词分配一个标签或类别

常用标注模式：IO、BIO、BIOES
## 基于统计模型

基本原理：标签序列之间是有强相互依赖关系，借助统计模型，将信息抽取任务形式化为从文本输入到特定目标结构的预测

常见方法：最大熵分类模型（ME）、最大熵马尔可夫模型（MEMM）、支持向量机（SVM）、隐马尔可夫模型（HMM）、条件随机场（CRF）

局限：依赖专家、泛化性差

## 基于深度学习

基本思想：通过深度神经网络自动学习数据中的特征和模式

优势：无需人工定义特征模板，能自动学习有效特征

深度学习模型架构：

- 输入层分布式表示：字符向量化，考虑单词和字符级别的嵌入，以及其他相关语义标签
- 上下文编码器：获得文本的特征向量，使用RNN、LSTM、BERT等网络捕捉上下文相关性
- 标签解码器：预测输入序列的标签，训练标签解码器以检测实体边界，预测相应的标签类型

# 命名实体识别（专名识别）

##  命名实体及分类

命名实体一般指文本中具有特定意义或者指代性强的实体，通常包括人名、地名、组织机构名、日期时间、专有名词等。

3大类（数字、实体、时间）

7小类：人名、地名、组织机构名、时间、日期、货币、百分比

作用：信息抽取基础任务

## 命名实体识别任务

### 基于LSTM的NER

使用LSTM学习文本特征表示，利用CRF进行标签预测
### 基于预训练语言模型的NER

优点：通过Self-attention机制，建立上下文联系，可以在特定任务上进行微调，泛化性能较好

两种类型：Bert+MLP+Softmax、Bert+CRF

Bert+MLP+Softmax：交叉熵损失函数

优点：训练和推理相对简单，计算效率高；适用于简单的标注任务，不考虑标签之间的复杂关系

缺点：没有明确序列依赖关系，易产生错误预测

Bert+CRF：负对数似然损失函数

优点：在序列标注中考虑了标签之间的依赖关系，更适用于需要考虑标签序列整体结构的复杂任务

缺点：训练和推理相对复杂，计算代价高；在某些简单任务上可能会过于复杂，导致过拟合

### 中文命名实体识别的难点

难点：

1. 词语切分
2. 多义词和歧义词
3. 命名实体的种类多样
4. 数据标注困难
5. 命名实体的上下文依赖性



### 细粒度命名实体识别

更细致

难点：

1. 数据标注困难
2. 类别不平衡问题
3. 上下文语境依赖性
4. 模型复杂度及训练困难


# 实体关系抽取

什么是关系抽取？

关系抽取也叫三元组抽取，从文本中同时抽取两个实体及其对应关系

三元组可以表示为（Subject, Relation, Object）或（Subject, Prodicate, Object）

关系抽取=实体识别+关系分类

## 知识图谱

什么是知识图谱？

知识图谱是一种语义网络，用以抽象现实世界的实体、概念及关系，并以三元组的形式来表示知识。

知识图谱由三类元素构成：

- 实体（entity）
- 属性（literal）
- 关系（relation）

图谱数据的组织和存储：

- 图数据由节点和边组成
- 节点：表示现实世界中存在的实体或实体的属性
- 边：实体与实体之间的关系
- 关系不仅可以用于连接两个实体也可以连接实体和某属性

知识图谱可以使用图数据库如Neo4j存储。

## 抽取式模型

分类

1. 基于标注的模型
2. 基于片段的模型
3. 基于填表的模型
4. 基于阅读理解的模型
## 基于深度学习的实体关系抽取

### 流水线模型

流程：

1. 建立实体识别模型：对句子进行实体识别
2. 建立关系分类模型：将识别出的实体两两组合，进行关系分类，预测判断提取的实体之间是否存在某种关系

缺点：

1. 误差传播
2. 子任务间缺乏交互
3. 产生冗余信息
### 联合RE模型（端到端）

将实体抽取和关系分类两个子任务整合，联合学习，优化编码和解码

两个子任务间的信息交互，提升了实体关系抽取的效果

两大类型：基于参数共享（多任务学习）的实体关系抽取、基于关系重叠（联合解码、结构化预测）的实体关系抽取



# 事件抽取

什么是事件抽取？

事件抽取：自动从非结构化文本中获取事件并进行结构化展示

事件抽取=事件识别+角色分类

## 事件及其组成元素

事件：指在特定时间、地点，并涉及一个或多个参与者的某件事的特定发生，通常可以描述为状态的变化

事件组成元素：

1. 触发词
2. 事件类型
3. 论元：事件的参与者
4. 论元角色：论元在事件中充当的角色

## 事件抽取任务

包括事件识别、角色分类两个子任务

### Pipeline模型

对句子进行编码，然后把事件抽取转换为多阶段的分类问题，将第一个子任务的输出作为第二个子任务的输入，任务之间存在依赖关系

缺点：

1. 误差传递
2. 缺乏交互

### 联合抽取模型

对句子进行编码，将事件类型检测和论元识别两个子任务整合，在一个模型中联合学习，优化编码和解码

优点：

- 避免了触发词识别错误影响论元提取
- 减少了子任务模型的数量，增强了不同子任务模块之间的关联和交互，缓解了误差累积问题

缺点：

- 本质上还是多任务模型，没有解决误差传递的问题
- 预测时触发词和论元的识别连续进行，难以避免事件类型预测错误对论元抽取的影响

